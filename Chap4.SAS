#exp4.1-5.2forecast

data qwe;
input x1 x2 x3;
 y=dif(x1);
t=_n_;
cards;
1196.80      1993      1
1181.30      1993      2
1222.60      1993      3
1229.30      1993      4
1221.50      1993      5
1148.40      1993      6
1250.20      1993      7
1174.40      1993      8
1234.50      1993      9
1209.70      1993      10
1206.50      1993      11
1204.00      1993      12
1234.10      1994      1
1146.00      1994      2
1304.90      1994      3
1221.90      1994      4
1244.10      1994      5
1194.40      1994      6
1281.50      1994      7
1277.30      1994      8
1238.90      1994      9
1267.50      1994      10
1200.90      1994      11
1245.50      1994      12
1249.90      1995      1
1220.10      1995      2
1267.40      1995      3
1182.30      1995      4
1221.70      1995      5
1178.10      1995      6
1261.60      1995      7
1274.50      1995      8
1196.40      1995      9
1222.60      1995      10
1174.70      1995      11
1212.60      1995      12
1215.00      1996      1
1191.00      1996      2
1179.00      1996      3
1224.00      1996      4
1183.00      1996      5
1288.00      1996      6
1274.00      1996      7
1218.00      1996      8
1263.00      1996      9
1205.00      1996      10
1210.00      1996      11
1243.00      1996      12
1266.00      1997      1
1200.00      1997      2
1306.00      1997      3
1209.00      1997      4
1248.00      1997      5
1208.00      1997      6
1231.00      1997      7
1244.00      1997      8
1296.00      1997      9
1221.00      1997      10
1287.00      1997      11
1191.00      1997      12
;

proc arima;
 identify var=y;
 estimate  p=(2) q=1 maxiter=100 method=uls;
 forecast lead=30 id=t out=result;
run;


proc gplot data=result;
plot forecast*t=1 y*t=2/overlap;
symbol1 c=black v=none i=join;
symbol2 c=red v=none i=join;
run;


#exp4.2

#1
data gdp;
input year 2-5 qtr 7-8  x 12-18;
 y=log10(x) ;
 z=dif( dif(y) ) ;
t=_n_;
cards;
 1983 01 335253.8
 1983 02 555372.3
 1983 03 885478.4
 1983 04 005590.5
 1984 01 005699.8
 1984 02 335797.9
 1984 03 115854.3
 1984 04 115902.4
 1985 01 115956.9
 1985 02 116007.8
 1985 03 336101.7
 1985 04 776148.6
 1986 01 226207.4
 1986 02 776232.0
 1986 03 226291.7
 1986 04 996323.4
 1987 01 446365.0
 1987 02 446435.0
 1987 03 006493.4
 1987 04 666606.8
 1988 01 666639.1
 1988 02 886723.5
 1988 03 226759.4
 1988 04 556848.6
 1989 01 006918.1
 1989 02 116963.5
 1989 03 667013.1
 1989 04 557030.9
 1990 01 007112.1
 1990 02 007130.3
 1990 03 557130.8
 1990 04 557076.9
 1991 01 887040.8
 1991 02 007086.5
 1991 03 557120.7
 1991 04 997154.1
 1992 01 887228.2
 1992 02 557297.9
 1992 03 117369.5
 1992 04 447450.7
 1993 01 447459.7
 1993 02 557497.5
 1993 03 777536.0
 1993 04 117637.4
 1994 01 557715.1
 1994 02 117815.7
 1994 03 887859.5
 1994 04 117951.6
 1995 01 227973.7
 1995 02 557988.0
 1995 03 448053.1
 1995 04 558112.0
 1996 01 338169.2
 1996 02 558303.1
 1996 03 118372.7
 1996 04 888470.6
 1997 01 118536.1
 1997 02 668665.8
 1997 03 558773.7
 1997 04 888838.4
 1998 01 558936.2
 1998 02 778995.3
 1998 03 119098.9
 1998 04 999237.1
 1999 01 779315.5
 1999 02 559392.6
 1999 03 339502.2
 1999 04 559671.1
 2000 01 119695.6
 2000 02 229847.9
 2000 03 119836.6
 2000 04 559887.7
 2001 01 229875.6
 2001 02 009905.9
 2001 03 779871.1
 2001 04 449910.0
 2002 01 339977.3
 2002 02 7 10031.6
 2002 03 8 10090.7
 2002 04 5 10095.8
 2003 01 4 10138.6
 2003 02 2 10230.4
 2003 03 9 10410.9
 2003 04 2 10502.6
 2004 01 6 10612.5
 2004 02 7 10704.1
 2004 03 7 10808.9
 2004 04 7 10897.1
 2005 01 8 10999.3
 2005 02 3 11089.2
 2005 03 1 11202.3
 2005 04 9 11233.5
run;

proc gplot;
plot z*t=1;
symbol1 c=black v=none i=join;
run;

proc arima;
 identify var=z  nlag=25;
 estimate q=1 maxiter=100 method=uls;
 estimate q=2 maxiter=100 method=uls;
 estimate q=3 maxiter=100 method=uls;
run;

#2-ppt
data gdp2;   
set shx1.gdp1;
y=log10(x);
z=dif(dif(y));
time=intnx('quarter','01jan1983'd,_n_-1);
format time date.;  #对国内生产总值进行平稳化处理。对先去对数，再进行二阶差分。

proc gplot data=gdp2;
plot z*time=1;
symbol1 c=blue v=dot i=join;
run;   #绘制时序图

proc arima data=gdp2;
identify var=z nlag=25;   #模型识别：从时序图可以看出，序列Xt是平稳的。用Box-Jenkins方法建模，Xt的自相关函数和偏自相关函数，可以判断出样本自相关系数序列3步截尾，偏自相关系数缓慢衰减，呈拖尾现象。故可初步判断序列Xt适合MA模型。
estimate q=1 maxiter=100 method=uls;
estimate q=2 maxiter=100 method=uls;
estimate q=3 maxiter=100 method=uls;
run;    #拟合MA(m)模型、模型适应性检验、残差自相关检验


#exp4.3

data gdp;
input year 2-5 qtr 8  x 11-16;
 z=dif( dif(x) ) ;
t=_n_;
cards;
 1990 013 4757.1
 1990 029 4773.0
 1990 038 4792.6
 1990 042 4758.3
 1991 01 94738.1
 1991 02 64779.4
 1991 03 24800.1
 1991 04 04795.9
 1992 015 4875.0
 1992 022 4903.0
 1992 033 4951.8
 1992 046 5009.4
 1993 01 05027.3
 1993 02 65071.9
 1993 03 55127.3
 1993 04 95172.9
 1994 013 5230.3
 1994 029 5268.0
 1994 035 5305.7
 1994 046 5358.7
 1995 01 35367.2
 1995 02 65411.7
 1995 03 55458.8
 1995 04 55496.1
 1996 015 5544.6
 1996 028 5604.9
 1996 030 5640.7
 1996 042 5687.6
 1997 01 85749.1
 1997 02 25775.8
 1997 03 65870.7
 1997 04 85931.4
 1998 015 5996.8
 1998 020 6092.1
 1998 038 6165.7
 1998 049 6248.8
 1999 01 26311.3
 1999 02 66409.7
 1999 03 96476.7
 1999 04 96556.8
 2000 010 6661.3
 2000 025 6703.3
 2000 032 6768.0
 2000 046 6825.0
 2001 01 26853.1
 2001 02 06870.3
 2001 03 06900.5
 2001 04 47017.6
 2002 014 7042.2
 2002 021 7083.5
 2002 034 7123.2
 2002 041 7148.2
 2003 01 37192.2
 2003 02 57256.8
 2003 03 87360.7
 2003 04 77416.4
 2004 018 7501.4
 2004 020 7536.6
 2004 030 7617.5
 2004 044 7698.8
 2005 01 67764.9
 2005 02 37829.5
 2005 03 57907.9
 2005 04 37930.2
run;

proc gplot;
plot z*t=1;
symbol1 c=black v=none i=join;
run;

proc arima;

  identify var=z;
  estimate q=1 method=uls;
  estimate p=4 q=3 method=uls;
  estimate p=2 q=1 method=uls;
  estimate p=1 q=1 method=uls;
run;
